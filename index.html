<!-- –î–æ–±–∞–≤–ª—è–µ–º –≤ body –ø–æ—Å–ª–µ —Å—Ç–∞—Ç—É—Å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ -->
<div class="crafting-section">
    <h3>‚öíÔ∏è –ö—Ä–∞—Ñ—Ç–∏–Ω–≥</h3>
    <div class="crafting-grid" id="crafting-recipes"></div>
</div>

<script>
// 1. –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
class CharacterClass {
    constructor(type) {
        this.types = {
            warrior: { attack: 15, defense: 10, skill: '–ë–µ—Ä—Å–µ—Ä–∫' },
            mage: { attack: 8, defense: 5, skill: '–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä' },
            rogue: { attack: 10, defense: 7, skill: '–°–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å' }
        };
        return this.types[type];
    }
}

// 2. –°–∏—Å—Ç–µ–º–∞ –∫—Ä–∞—Ñ—Ç–∞
const craftingRecipes = [
    {
        result: 'üó°Ô∏è –ú–µ—á –¥—Ä–∞–∫–æ–Ω–∞',
        requirements: { 'üêâ –ß–µ—à—É—è –¥—Ä–∞–∫–æ–Ω–∞': 3, 'üî• –ü–ª–∞–º—è': 5 },
        class: 'warrior'
    },
    {
        result: 'üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π —Å–≤–∏—Ç–æ–∫',
        requirements: { 'üìú –ü–µ—Ä–≥–∞–º–µ–Ω—Ç': 2, 'üíß –≠—Å—Å–µ–Ω—Ü–∏—è –º–∞–Ω—ã': 4 },
        class: 'mage'
    }
];

function renderCrafting() {
    const container = document.getElementById('crafting-recipes');
    container.innerHTML = craftingRecipes.map(recipe => `
        <div class="recipe">
            <h4>${recipe.result}</h4>
            ${Object.entries(recipe.requirements).map(([item, count]) => `
                <div>${item} x${count}</div>
            `).join('')}
            <button onclick="craftItem('${recipe.result}')">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
    `).join('');
}

// 3. –¢–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
class Marketplace {
    constructor() {
        this.listings = [];
    }

    addListing(item, price, seller) {
        this.listings.push({ item, price, seller });
    }

    buyItem(itemId, buyer) {
        const item = this.listings[itemId];
        if (buyer.gold >= item.price) {
            buyer.gold -= item.price;
            buyer.inventory.push(item.item);
            Telegram.WebApp.sendData(JSON.stringify({
                type: 'TRADE',
                data: { item: item.item, price: item.price }
            }));
        }
    }
}

// 4. –°–∏—Å—Ç–µ–º–∞ –≥–∏–ª—å–¥–∏–π
class Guild {
    constructor(name, leader) {
        this.name = name;
        this.members = [leader];
        this.treasury = 0;
        this.quests = [];
    }

    addMember(player) {
        if (this.members.length < 50) {
            this.members.push(player);
        }
    }
}

// 5. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
const dailyQuests = [
    {
        id: 1,
        title: '–°–±–æ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤',
        objective: '–°–æ–±–µ—Ä–∏—Ç–µ 10 –µ–¥–∏–Ω–∏—Ü –¥—Ä–µ–≤–µ—Å–∏–Ω—ã',
        reward: { gold: 100, exp: 50 }
    },
    {
        id: 2,
        title: '–û—Ö–æ—Ç–∞ –Ω–∞ –º–æ–Ω—Å—Ç—Ä–æ–≤',
        objective: '–ü–æ–±–µ–¥–∏—Ç–µ 5 —Å–∫–µ–ª–µ—Ç–æ–≤',
        reward: { gold: 200, exp: 100 }
    }
];

// 6. NFT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ–º TON Blockchain)
async function mintNFT(item) {
    const response = await fetch('https://api.tonnft.com/mint', {
        method: 'POST',
        body: JSON.stringify({
            item,
            owner: tg.initDataUnsafe.user.id
        })
    });
    return response.json();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
const marketplace = new Marketplace();
let playerClass = new CharacterClass('warrior');
let guild = null;

// –û–±–Ω–æ–≤–ª—è–µ–º –∏–≥—Ä–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É
function startCombat() {
    // –î–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å—ã –∫–ª–∞—Å—Å–∞
    const classBonus = playerClass.attack * gameState.level;
    // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—è ...
}

// –î–æ–±–∞–≤–ª—è–µ–º –≤ gameState
gameState.dailyQuests = [];
gameState.craftingMaterials = {};
gameState.nftItems = [];

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è NFT
async function completeEpicQuest() {
    const nft = await mintNFT('üêâ –°–µ—Ä–¥—Ü–µ –¥—Ä–∞–∫–æ–Ω–∞');
    gameState.nftItems.push(nft);
    tg.showAlert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ NFT: ${nft.id}`);
}
</script>
