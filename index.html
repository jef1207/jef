<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Auth без хранения данных</title>
    <style>
        .container {
            max-width: 400px;
            margin: 50px auto;
            text-align: center;
        }
        #gsi-btn {
            background: #4285F4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="gsi-btn"></div>
        <div id="user-info"></div>
    </div>

    <script>
        // Конфигурация Google Identity Services
        function initializeGsi() {
            google.accounts.id.initialize({
                client_id: 'YOUR_CLIENT_ID.apps.googleusercontent.com',
                callback: handleCredentialResponse,
                auto_select: false,
                cancel_on_tap_outside: true,
                context: 'use'
            });
            
            google.accounts.id.renderButton(
                document.getElementById("gsi-btn"),
                { 
                    type: "standard",
                    size: "large",
                    text: "signin_with",
                    shape: "rectangular"
                }
            );
        }

        // Обработка ответа авторизации
        function handleCredentialResponse(response) {
            // Декодирование JWT без отправки на сервер
            const userData = parseJwt(response.credential);
            
            // Отображение информации (без сохранения)
            showUserInfo(userData);
            
            // Важно: не сохраняем credential в localStorage/sessionStorage
            console.log('Аутентификация успешна, данные не сохранены');
        }

        // Парсинг JWT токена
        function parseJwt(token) {
            try {
                return JSON.parse(atob(token.split('.')[1]));
            } catch (e) {
                console.error('Ошибка парсинга JWT:', e);
                return null;
            }
        }

        // Отображение информации о пользователе
        function showUserInfo(data) {
            const userInfo = document.getElementById('user-info');
            userInfo.innerHTML = `
                <h3>Добро пожаловать, ${data.name}!</h3>
                <p>Email: ${data.email}</p>
                <button onclick="logout()">Выйти</button>
            `;
        }

        // Выход без сохранения сессии
        function logout() {
            google.accounts.id.disableAutoSelect();
            document.getElementById('user-info').innerHTML = '';
            console.log('Сессия завершена, данные удалены из памяти');
        }

        // Загрузка GSI скрипта
        (function() {
            const script = document.createElement('script');
            script.src = 'https://accounts.google.com/gsi/client';
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
            script.onload = initializeGsi;
        })();
    </script>
</body>
</html>
